---
title: 'GoogleMeetのマイクをアプリケーション外から操作するには(Mac)'
emoji: '👌'
type: 'tech' # tech: 技術記事 / idea: アイデア
topics: [macOS]
published: true
---

# 背景

GoogleMeet をサブディスプレイに写しつつ､メインディスプレイで作業していたりすると
マイクの On/Off の切り替えをするためだけにブラウザを切り替える必要があり､楽にできないかなぁと思ってました

Alfred や Raycast などのランチャー､もしくはショートカットキーに登録しマイクを操作できるといいなぁ､と考え
解決策を探ってみた記事です｡

:::message alert
結論
仮想HIDを作成しそれをプロキシとして送信すべし
:::

## 案1 マイクレベルを操作

macOS レベルでマイクの入力レベルでコントロールする

```
osascript -e "set volume without output muted"
```
```
osascript -e "set volume with output muted"
```

確かに､マイクのInputレベルをコントロールできている､が
Inputレベルが0なだけで､`Mute`か`Unmute`かでいうと`Unmute`な状態と判定されるため､
普通に声が漏れる｡だめ


## 案2 Selenium
GoogleMeetの場合､マイクのトグルはショートカットで提供されている
そこで､Seleniumで対象のブラウザをURLで探し出し､ショートカットキーを送信すれば
トグルが実現できるはず｡

操作するためには､ブラウザにSelenium WebDriverが読み込まれた状態でブラウザを起動する必要がある
しかし､GoogleMeetの操作のためだけに普段使いするブラウザにWebDriverをいれっぱなしにするのはどうかと思うので諦め

## 案3 HID
GoogleMeetに新機能として､HID経由でマイクを操作できる機能がついかされていた｡これだ！
![](/images/d5dc7064a1a2e9/hid.png)

何故か外部キーボードしかだめで､Mac内蔵キーボードは無視されている｡
そこで､仮想的にHIDを作成し(Karabinerの仮想キーボードのように)､それを通じてMuteコマンドを送信する｡

